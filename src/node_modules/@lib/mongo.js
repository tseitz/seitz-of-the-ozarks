const MongoClient = require("mongodb").MongoClient;
require('dotenv').config()
const assert = require("assert");

let client = null;
let db = null;

export async function init() {
  if (!connected) {
    const uri = `mongodb+srv://${process.env.MONGO_USER}:${process.env.MONGO_PASS}@${process.env.MONGO_HOST}/test?retryWrites=true&w=majority`
    const mongoClient = new MongoClient(uri, {
      useNewUrlParser: true,
      useUnifiedTopology: true,
    })

    client = await mongoClient.connect()
    db = client.db('test')
  }
  return { connected, db }
}